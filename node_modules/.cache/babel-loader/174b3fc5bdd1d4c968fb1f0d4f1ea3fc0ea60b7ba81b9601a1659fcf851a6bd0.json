{"ast":null,"code":"// /src/api/googleAPI.js\n/* global gapi, google  */\nconst CLIENT_ID = process.env.REACT_APP_CLIENT_ID;\nconst API_KEY = process.env.REACT_APP_API_KEY;\nconst DISCOVERY_DOCS = [\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"];\nconst SCOPES = 'https://www.googleapis.com/auth/drive.file';\nlet tokenClient;\nexport function initGoogleAPI() {\n  // Primero, asegurarse de que gapi se carga correctamente.\n  return new Promise((resolve, reject) => {\n    gapi.load('client', () => {\n      gapi.client.init({\n        apiKey: API_KEY,\n        clientId: CLIENT_ID,\n        // Asegúrate de incluir el clientId aquí.\n        discoveryDocs: DISCOVERY_DOCS,\n        scope: SCOPES\n      }).then(() => {\n        // Inicializar el cliente de token después de que gapi se haya inicializado correctamente.\n        tokenClient = google.accounts.oauth2.initTokenClient({\n          client_id: CLIENT_ID,\n          scope: SCOPES,\n          prompt: ''\n        });\n        resolve();\n      }).catch(error => {\n        reject(error);\n      });\n    });\n  });\n}\nexport function logout() {\n  return new Promise(resolve => {\n    google.accounts.id.disableAutoSelect();\n    resolve({\n      access_token: '',\n      expires_in: 0\n    });\n  });\n}\nexport function login() {\n  return new Promise(resolve => {\n    tokenClient.callback = token => {\n      getUserInfo(token.access_token).then(userInfo => {\n        resolve({\n          token,\n          userInfo\n        });\n      });\n    };\n    tokenClient.requestAccessToken({\n      prompt: ''\n    });\n  });\n}\nfunction getUserInfo(accessToken) {\n  const userInfoEndpoint = 'https://www.googleapis.com/oauth2/v1/userinfo';\n  return fetch(userInfoEndpoint, {\n    headers: {\n      Authorization: `Bearer ${accessToken}`\n    }\n  }).then(response => response.json());\n}","map":{"version":3,"names":["CLIENT_ID","process","env","REACT_APP_CLIENT_ID","API_KEY","REACT_APP_API_KEY","DISCOVERY_DOCS","SCOPES","tokenClient","initGoogleAPI","Promise","resolve","reject","gapi","load","client","init","apiKey","clientId","discoveryDocs","scope","then","google","accounts","oauth2","initTokenClient","client_id","prompt","catch","error","logout","id","disableAutoSelect","access_token","expires_in","login","callback","token","getUserInfo","userInfo","requestAccessToken","accessToken","userInfoEndpoint","fetch","headers","Authorization","response","json"],"sources":["D:/xampp/htdocs/src/apis/googleAPI.js"],"sourcesContent":["// /src/api/googleAPI.js\r\n/* global gapi, google  */\r\nconst CLIENT_ID = process.env.REACT_APP_CLIENT_ID;\r\nconst API_KEY = process.env.REACT_APP_API_KEY;\r\nconst DISCOVERY_DOCS = [\"https://www.googleapis.com/discovery/v1/apis/drive/v3/rest\"];\r\nconst SCOPES = 'https://www.googleapis.com/auth/drive.file';\r\n\r\nlet tokenClient;\r\n\r\nexport function initGoogleAPI() {\r\n  // Primero, asegurarse de que gapi se carga correctamente.\r\n  return new Promise((resolve, reject) => {\r\n    gapi.load('client', () => {\r\n      gapi.client.init({\r\n        apiKey: API_KEY,\r\n        clientId: CLIENT_ID, // Asegúrate de incluir el clientId aquí.\r\n        discoveryDocs: DISCOVERY_DOCS,\r\n        scope: SCOPES,\r\n      })\r\n        .then(() => {\r\n          // Inicializar el cliente de token después de que gapi se haya inicializado correctamente.\r\n          tokenClient = google.accounts.oauth2.initTokenClient({\r\n            client_id: CLIENT_ID,\r\n            scope: SCOPES,\r\n            prompt: '',\r\n          });\r\n          resolve();\r\n        })\r\n        .catch(error => {\r\n          reject(error);\r\n        });\r\n    });\r\n  });\r\n}\r\n\r\n\r\nexport function logout() {\r\n  return new Promise((resolve) => {\r\n    google.accounts.id.disableAutoSelect();\r\n    resolve({ access_token: '', expires_in: 0 });\r\n  });\r\n}\r\n\r\nexport function login() {\r\n  return new Promise((resolve) => {\r\n    tokenClient.callback = (token) => {\r\n      getUserInfo(token.access_token)\r\n        .then(userInfo => { resolve({ token, userInfo }); })\r\n    };\r\n    tokenClient.requestAccessToken({ prompt: '' });\r\n  });\r\n}\r\n\r\nfunction getUserInfo(accessToken) {\r\n  const userInfoEndpoint = 'https://www.googleapis.com/oauth2/v1/userinfo';\r\n  return fetch(userInfoEndpoint, {\r\n    headers: { Authorization: `Bearer ${accessToken}` }\r\n  })\r\n    .then(response => response.json())\r\n}\r\n"],"mappings":"AAAA;AACA;AACA,MAAMA,SAAS,GAAGC,OAAO,CAACC,GAAG,CAACC,mBAAmB;AACjD,MAAMC,OAAO,GAAGH,OAAO,CAACC,GAAG,CAACG,iBAAiB;AAC7C,MAAMC,cAAc,GAAG,CAAC,4DAA4D,CAAC;AACrF,MAAMC,MAAM,GAAG,4CAA4C;AAE3D,IAAIC,WAAW;AAEf,OAAO,SAASC,aAAaA,CAAA,EAAG;EAC9B;EACA,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,IAAI,CAACC,IAAI,CAAC,QAAQ,EAAE,MAAM;MACxBD,IAAI,CAACE,MAAM,CAACC,IAAI,CAAC;QACfC,MAAM,EAAEb,OAAO;QACfc,QAAQ,EAAElB,SAAS;QAAE;QACrBmB,aAAa,EAAEb,cAAc;QAC7Bc,KAAK,EAAEb;MACT,CAAC,CAAC,CACCc,IAAI,CAAC,MAAM;QACV;QACAb,WAAW,GAAGc,MAAM,CAACC,QAAQ,CAACC,MAAM,CAACC,eAAe,CAAC;UACnDC,SAAS,EAAE1B,SAAS;UACpBoB,KAAK,EAAEb,MAAM;UACboB,MAAM,EAAE;QACV,CAAC,CAAC;QACFhB,OAAO,CAAC,CAAC;MACX,CAAC,CAAC,CACDiB,KAAK,CAACC,KAAK,IAAI;QACdjB,MAAM,CAACiB,KAAK,CAAC;MACf,CAAC,CAAC;IACN,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;AAGA,OAAO,SAASC,MAAMA,CAAA,EAAG;EACvB,OAAO,IAAIpB,OAAO,CAAEC,OAAO,IAAK;IAC9BW,MAAM,CAACC,QAAQ,CAACQ,EAAE,CAACC,iBAAiB,CAAC,CAAC;IACtCrB,OAAO,CAAC;MAAEsB,YAAY,EAAE,EAAE;MAAEC,UAAU,EAAE;IAAE,CAAC,CAAC;EAC9C,CAAC,CAAC;AACJ;AAEA,OAAO,SAASC,KAAKA,CAAA,EAAG;EACtB,OAAO,IAAIzB,OAAO,CAAEC,OAAO,IAAK;IAC9BH,WAAW,CAAC4B,QAAQ,GAAIC,KAAK,IAAK;MAChCC,WAAW,CAACD,KAAK,CAACJ,YAAY,CAAC,CAC5BZ,IAAI,CAACkB,QAAQ,IAAI;QAAE5B,OAAO,CAAC;UAAE0B,KAAK;UAAEE;QAAS,CAAC,CAAC;MAAE,CAAC,CAAC;IACxD,CAAC;IACD/B,WAAW,CAACgC,kBAAkB,CAAC;MAAEb,MAAM,EAAE;IAAG,CAAC,CAAC;EAChD,CAAC,CAAC;AACJ;AAEA,SAASW,WAAWA,CAACG,WAAW,EAAE;EAChC,MAAMC,gBAAgB,GAAG,+CAA+C;EACxE,OAAOC,KAAK,CAACD,gBAAgB,EAAE;IAC7BE,OAAO,EAAE;MAAEC,aAAa,EAAG,UAASJ,WAAY;IAAE;EACpD,CAAC,CAAC,CACCpB,IAAI,CAACyB,QAAQ,IAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC;AACtC"},"metadata":{},"sourceType":"module","externalDependencies":[]}