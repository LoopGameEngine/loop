{"ast":null,"code":"//driverAPI.js\n/* global gapi */\n\nlet accessToken;\nvar openWindows = {};\nvar expandContainer = document.querySelector('.expand-container');\nvar expandContainerUl = document.querySelector('.expand-container ul');\nfunction setDriveAccessToken(token) {\n  accessToken = token;\n}\nfunction folderExists(folderName) {\n  return new Promise((resolve, reject) => {\n    gapi.client.drive.files.list({\n      q: `name='${folderName}' and trashed=false`\n    }).then(response => {\n      if (response.result.files && response.result.files.length > 0) {\n        const folderId = response.result.files[0].id;\n        resolve(folderId);\n      } else {\n        resolve(undefined);\n      }\n    }).catch(error => {\n      console.error('Error checking folder existence:', error.message);\n      reject(error);\n    });\n  });\n}\nfunction checkDriveFolder(loopGamesFolder) {\n  return new Promise(function (resolve, reject) {\n    gapi.client.drive.files.list({\n      q: \"name ='\" + loopGamesFolder + \"' and trashed=false\",\n      fields: 'files(id,name,owners(displayName))'\n    }).then(function (response) {\n      var files = response.result.files;\n      if (files && files.length > 0) {\n        resolve(files[0].id);\n      } else {\n        createFolder(loopGamesFolder, 'root', accessToken).then(function (folderId) {\n          resolve(folderId);\n        }).catch(function (error) {\n          reject(new Error('Failed to create folder: ' + error.message));\n        });\n      }\n    }).catch(function (error) {\n      reject(new Error('Failed to list files: ' + error.message));\n    });\n  });\n}\nfunction listDriveGames(appFolderID) {\n  return new Promise((resolve, reject) => {\n    if (appFolderID) {\n      gapi.client.drive.files.list({\n        'q': `parents in \"${appFolderID}\"`,\n        // Listar juegos del usuario\n        'fields': 'files(id, name)'\n      }).then(async response => {\n        const files = response.result.files;\n        for (let i = files.length - 1; i >= 0; i--) {\n          const gameFolderID = files[i].id;\n          try {\n            files[i].imageUrl = await getImageDownloadUrl(gameFolderID);\n          } catch (error) {\n            console.error(error.message);\n          }\n        }\n        resolve(files);\n      }).catch(error => {\n        reject(new Error('Error al listar los juegos de Google Drive: ' + error.message));\n      });\n    }\n  });\n}\nfunction getImageDownloadUrl(gameFolderID) {\n  return new Promise((resolve, reject) => {\n    // Buscar el archivo de la imagen por nombre en el directorio del juego\n    gapi.client.drive.files.list({\n      'q': `name='image.jpg' and '${gameFolderID}' in parents`,\n      'fields': 'files(id)'\n    }).then(response => {\n      const files = response.result.files;\n      if (files && files.length > 0) {\n        const imageFileId = files[0].id;\n        return gapi.client.drive.files.get({\n          'fileId': imageFileId,\n          'alt': 'media'\n        });\n      } else {\n        reject(new Error('No se encontró el archivo de imagen en el directorio del juego.'));\n      }\n    }).then(res => {\n      const type = res.headers[\"Content-Type\"];\n      const blob = new Blob([new Uint8Array(res.body.length).map((_, i) => res.body.charCodeAt(i))]);\n      const objectUrl = URL.createObjectURL(blob, {\n        type\n      });\n      resolve(objectUrl);\n    }).catch(error => {\n      reject(new Error('Error obteniendo la URL de descarga de la imagen: ' + error.message));\n    });\n  });\n}\nasync function newGame(appFolderID) {\n  var gameID;\n  return new Promise((resolve, reject) => {\n    createFolder(\"Untitled Game\", appFolderID).then(function (folderId) {\n      gameID = folderId;\n      return createEmptyJson(gameID);\n    }).then(function () {\n      return createEmptyImage(gameID);\n    }).then(function () {\n      return createFolder(\"images\", gameID);\n    }).then(function () {\n      return createFolder(\"sounds\", gameID);\n    }).then(function () {\n      resolve(gameID);\n    }).catch(function (error) {\n      console.error(\"Failed to create game:\", error);\n      reject(error);\n    });\n  });\n}\nfunction editGame(menuItemHTML) {\n  var gameID = menuItemHTML.parentNode.getAttribute(\"gameid\");\n  var url = \"editor/?id=\" + gameID;\n  if (openWindows[url] && !openWindows[url].closed) openWindows[url].focus();else openWindows[url] = window.open(url, \"_blank\");\n  expandContainer.style.display = 'none';\n  expandContainerUl.setAttribute('gameid', '');\n}\nfunction playGame(menuItemHTML) {\n  var gameID = menuItemHTML.parentNode.getAttribute(\"gameid\");\n  var url = \"engine/?id=\" + gameID;\n  if (openWindows[url] && !openWindows[url].closed) openWindows[url].focus();else openWindows[url] = window.open(url, \"_blank\");\n  expandContainer.style.display = 'none';\n  expandContainerUl.setAttribute('gameid', '');\n}\nasync function duplicateGame(gameID) {\n  return new Promise((resolve, reject) => {\n    gapi.client.drive.files.get({\n      'fileId': gameID,\n      'fields': 'name, parents'\n    }).then(response => {\n      console.log('Game Folder Retrieved');\n      const duplicateFolderName = response.result.name + ' - Copy';\n      gapi.client.drive.files.create({\n        'resource': {\n          'name': duplicateFolderName,\n          'mimeType': 'application/vnd.google-apps.folder',\n          'parents': response.result.parents\n        }\n      }).then(res => {\n        const newDirectoryId = res.result.id;\n        copyDirectoryContents(gameID, newDirectoryId, duplicateFolderName).then(() => {\n          resolve();\n        }).catch(error => {\n          reject(new Error('Error copying directory contents: ' + error.message));\n        });\n      }).catch(error => {\n        reject(new Error('Error creating duplicated game folder: ' + error.message));\n      });\n    }).catch(error => {\n      reject(new Error('Error retrieving game folder: ' + error.message));\n    });\n  });\n}\nasync function deleteGame(gameID, gameName) {\n  var result = window.confirm(`Do you want to delete the \"${gameName}\" game?`);\n  if (result) {\n    try {\n      await gapi.client.drive.files.delete({\n        'fileId': gameID\n      });\n      console.log('File Deleted');\n    } catch (error) {\n      console.error('Error deleting game:', error.message);\n    }\n  } else {\n    console.log('Option selected: false');\n  }\n}\nasync function copyDirectoryContents(sourceDirectoryId, destinationDirectoryId, duplicateFolderName) {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const response = await gapi.client.drive.files.list({\n        'q': \"'\" + sourceDirectoryId + \"' in parents\",\n        'fields': 'files(id, name, mimeType)'\n      });\n      const files = response.result.files;\n      const copyFilePromises = files.map(async file => {\n        if (file.mimeType === 'application/vnd.google-apps.folder') {\n          await duplicateSubdirectory(file.id, destinationDirectoryId);\n        } else {\n          const copyRes = await gapi.client.drive.files.copy({\n            'fileId': file.id,\n            'parents': [destinationDirectoryId]\n          });\n          console.log('File Copied: ' + copyRes.result.name);\n          if (copyRes.result.name === \"game.json\") {\n            const originalGameJsonId = await getJson(sourceDirectoryId);\n            console.log('ID del archivo game.json:', originalGameJsonId);\n            await changeNameInJson(copyRes.result.id, originalGameJsonId, duplicateFolderName);\n          }\n        }\n      });\n      await Promise.all(copyFilePromises);\n      resolve();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\nfunction getJson(directoryId) {\n  var request = gapi.client.drive.files.list({\n    'q': \"name='game.json' and '\" + directoryId + \"' in parents\",\n    'fields': 'files(id)'\n  });\n  return new Promise(function (resolve, reject) {\n    request.execute(function (res) {\n      if (res.files.length > 0) {\n        var gameJsonId = res.files[0].id;\n        resolve(gameJsonId);\n      } else {\n        reject(new Error('No se encontró el archivo game.json en la carpeta original.'));\n      }\n    });\n  });\n}\nfunction changeNameInJson(duplicatedDirectoryId, originalGameJsonId, newName) {\n  var request = gapi.client.drive.files.get({\n    'fileId': originalGameJsonId,\n    'alt': 'media'\n  });\n  request.execute(function (res) {\n    var gameJsonContent = res;\n    gameJsonContent.name = newName;\n    var updatedJsonString = JSON.stringify(gameJsonContent);\n    var updateRequest = gapi.client.request({\n      'path': '/upload/drive/v3/files/' + duplicatedDirectoryId,\n      'method': 'PATCH',\n      'params': {\n        'uploadType': 'media'\n      },\n      'headers': {\n        'Content-Type': 'application/json'\n      },\n      'body': updatedJsonString\n    });\n    updateRequest.execute(function (updateRes) {\n      console.log('Nombre del juego duplicado actualizado: ' + newName);\n    });\n  });\n}\nfunction duplicateSubdirectory(sourceSubdirectoryId, destinationParentId) {\n  var request = gapi.client.drive.files.get({\n    'fileId': sourceSubdirectoryId,\n    'fields': 'name, parents'\n  });\n  request.execute(function (res) {\n    console.log('Subdirectory Retrieved');\n    var subdirectoryData = res;\n    var copyRequest = gapi.client.drive.files.create({\n      'resource': {\n        'name': subdirectoryData.name,\n        'mimeType': 'application/vnd.google-apps.folder',\n        'parents': [destinationParentId]\n      }\n    });\n    copyRequest.execute(function (copyRes) {\n      console.log('Subdirectory Duplicated');\n      var duplicatedSubdirectoryId = copyRes.id;\n      copyDirectoryContents(sourceSubdirectoryId, duplicatedSubdirectoryId);\n    });\n  });\n}\nfunction createFolder(folderName, parent, accessToken) {\n  console.log(\"createFolder \", folderName, parent);\n  return new Promise(function (resolve, reject) {\n    var request = gapi.client.request({\n      path: '/drive/v3/files',\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer ' + accessToken\n      },\n      body: {\n        'name': folderName,\n        'mimeType': 'application/vnd.google-apps.folder',\n        'parents': [parent]\n      }\n    });\n    request.execute(function (response) {\n      if (response.error) {\n        reject(new Error('Failed to create folder: ' + response.error.message));\n      } else if (response.id) {\n        resolve(response.id);\n      } else {\n        reject(new Error('Failed to create folder.'));\n      }\n    });\n  });\n}\n// Exporta las funciones necesarias si es necesario\nfunction createEmptyJson(gameID) {\n  return new Promise(function (resolve, reject) {\n    var request = gapi.client.request({\n      path: '/drive/v3/files',\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': 'Bearer ' + accessToken\n      },\n      body: {\n        'name': 'game.json',\n        'mimeType': 'application/json',\n        'parents': [gameID]\n      }\n    });\n    request.execute(function (response) {\n      if (response.error) {\n        reject(new Error('Failed to create JSON file: ' + response.error.message));\n      } else if (response.id) {\n        resolve(response.id);\n      } else {\n        reject(new Error('Failed to create JSON file.'));\n      }\n    });\n  });\n}\nfunction createEmptyImage(gameID) {\n  return new Promise(function (resolve, reject) {\n    var metadata = {\n      'name': 'image.jpg',\n      'parents': [gameID]\n    };\n    // Crear una imagen en blanco de 1x1 píxeles\n    var canvas = document.createElement('canvas');\n    canvas.width = 1;\n    canvas.height = 1;\n    var context = canvas.getContext('2d');\n    context.fillStyle = '#ffffff'; // Color blanco\n    context.fillRect(0, 0, 1, 1);\n    canvas.toBlob(function (blob) {\n      var reader = new FileReader();\n      reader.onloadend = function () {\n        var base64Data = reader.result.split(',')[1];\n        var boundary = '-------314159265358979323846';\n        var delimiter = '\\r\\n--' + boundary + '\\r\\n';\n        var close_delim = '\\r\\n--' + boundary + '--';\n        var multipartRequestBody = delimiter + 'Content-Type: application/json\\r\\n\\r\\n' + JSON.stringify(metadata) + delimiter + 'Content-Type: image/jpeg\\r\\n' + 'Content-Transfer-Encoding: base64\\r\\n' + '\\r\\n' + base64Data + close_delim;\n        gapi.client.request({\n          path: '/upload/drive/v3/files',\n          method: 'POST',\n          params: {\n            'uploadType': 'multipart'\n          },\n          headers: {\n            'Content-Type': 'multipart/related; boundary=\"' + boundary + '\"',\n            'Authorization': 'Bearer ' + accessToken\n          },\n          body: multipartRequestBody\n        }).then(function (response) {\n          var fileId = response.result.id;\n          resolve(fileId);\n        }).catch(function (error) {\n          reject(new Error('Failed to create image file: ' + error.result.error.message));\n        });\n      };\n      reader.readAsDataURL(blob);\n    }, 'image/jpeg');\n  });\n}\nexport { setDriveAccessToken, folderExists, createFolder, checkDriveFolder, listDriveGames, newGame, editGame, playGame, deleteGame, duplicateGame };","map":{"version":3,"names":["accessToken","openWindows","expandContainer","document","querySelector","expandContainerUl","setDriveAccessToken","token","folderExists","folderName","Promise","resolve","reject","gapi","client","drive","files","list","q","then","response","result","length","folderId","id","undefined","catch","error","console","message","checkDriveFolder","loopGamesFolder","fields","createFolder","Error","listDriveGames","appFolderID","i","gameFolderID","imageUrl","getImageDownloadUrl","imageFileId","get","res","type","headers","blob","Blob","Uint8Array","body","map","_","charCodeAt","objectUrl","URL","createObjectURL","newGame","gameID","createEmptyJson","createEmptyImage","editGame","menuItemHTML","parentNode","getAttribute","url","closed","focus","window","open","style","display","setAttribute","playGame","duplicateGame","log","duplicateFolderName","name","create","parents","newDirectoryId","copyDirectoryContents","deleteGame","gameName","confirm","delete","sourceDirectoryId","destinationDirectoryId","copyFilePromises","file","mimeType","duplicateSubdirectory","copyRes","copy","originalGameJsonId","getJson","changeNameInJson","all","directoryId","request","execute","gameJsonId","duplicatedDirectoryId","newName","gameJsonContent","updatedJsonString","JSON","stringify","updateRequest","updateRes","sourceSubdirectoryId","destinationParentId","subdirectoryData","copyRequest","duplicatedSubdirectoryId","parent","path","method","metadata","canvas","createElement","width","height","context","getContext","fillStyle","fillRect","toBlob","reader","FileReader","onloadend","base64Data","split","boundary","delimiter","close_delim","multipartRequestBody","params","fileId","readAsDataURL"],"sources":["D:/xampp/htdocs/app/src/driveAPI.js"],"sourcesContent":["\r\n//driverAPI.js\r\n/* global gapi */\r\n\r\nlet accessToken;\r\nvar openWindows = {};\r\nvar expandContainer = document.querySelector('.expand-container');\r\nvar expandContainerUl = document.querySelector('.expand-container ul');\r\n\r\nfunction setDriveAccessToken(token) {\r\n  accessToken = token;\r\n}\r\n\r\nfunction folderExists(folderName) {\r\n  return new Promise((resolve, reject) => {\r\n    gapi.client.drive.files.list({\r\n      q: `name='${folderName}' and trashed=false`,\r\n    }).then(response => {\r\n      if (response.result.files && response.result.files.length > 0) {\r\n        const folderId = response.result.files[0].id;\r\n        resolve(folderId);\r\n      } else {\r\n        resolve(undefined);\r\n      }\r\n    }).catch(error => {\r\n      console.error('Error checking folder existence:', error.message);\r\n      reject(error);\r\n    });\r\n  });\r\n}\r\n\r\n\r\nfunction checkDriveFolder(loopGamesFolder) {\r\n  return new Promise(function (resolve, reject) {\r\n    gapi.client.drive.files.list({\r\n      q: \"name ='\" + loopGamesFolder + \"' and trashed=false\",\r\n      fields: 'files(id,name,owners(displayName))'\r\n    }).then(function (response) {\r\n      var files = response.result.files;\r\n      if (files && files.length > 0) {\r\n        resolve(files[0].id);\r\n      } else {\r\n        createFolder(loopGamesFolder, 'root', accessToken).then(function (folderId) {\r\n          resolve(folderId);\r\n        }).catch(function (error) {\r\n          reject(new Error('Failed to create folder: ' + error.message));\r\n        });\r\n      }\r\n    }).catch(function (error) {\r\n      reject(new Error('Failed to list files: ' + error.message));\r\n    });\r\n  });\r\n}\r\n\r\nfunction listDriveGames(appFolderID) {\r\n  return new Promise((resolve, reject) => {\r\n    if (appFolderID) {\r\n      gapi.client.drive.files.list({\r\n        'q': `parents in \"${appFolderID}\"`, // Listar juegos del usuario\r\n        'fields': 'files(id, name)',\r\n      }).then(async response => {\r\n        const files = response.result.files;\r\n        for (let i = files.length - 1; i >= 0; i--) {\r\n          const gameFolderID = files[i].id;\r\n          try {\r\n            files[i].imageUrl = await getImageDownloadUrl(gameFolderID);\r\n          } catch (error) {\r\n            console.error(error.message);\r\n          }\r\n        }\r\n        resolve(files);\r\n      }).catch(error => {\r\n        reject(new Error('Error al listar los juegos de Google Drive: ' + error.message));\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction getImageDownloadUrl(gameFolderID) {\r\n  return new Promise((resolve, reject) => {\r\n    // Buscar el archivo de la imagen por nombre en el directorio del juego\r\n    gapi.client.drive.files.list({\r\n      'q': `name='image.jpg' and '${gameFolderID}' in parents`,\r\n      'fields': 'files(id)',\r\n    }).then(response => {\r\n      const files = response.result.files;\r\n      if (files && files.length > 0) {\r\n        const imageFileId = files[0].id;\r\n        return gapi.client.drive.files.get({\r\n          'fileId': imageFileId,\r\n          'alt': 'media',\r\n        });\r\n      } else {\r\n        reject(new Error('No se encontró el archivo de imagen en el directorio del juego.'));\r\n      }\r\n    }).then(res => {\r\n      const type = res.headers[\"Content-Type\"];\r\n      const blob = new Blob([new Uint8Array(res.body.length).map((_, i) => res.body.charCodeAt(i))]);\r\n      const objectUrl = URL.createObjectURL(blob, { type });\r\n      resolve(objectUrl);\r\n    }).catch(error => {\r\n      reject(new Error('Error obteniendo la URL de descarga de la imagen: ' + error.message));\r\n    });\r\n  });\r\n}\r\n\r\nasync function newGame(appFolderID) {\r\n  var gameID;\r\n  return new Promise((resolve, reject) => {\r\n    createFolder(\"Untitled Game\", appFolderID)\r\n      .then(function (folderId) {\r\n        gameID = folderId;\r\n        return createEmptyJson(gameID);\r\n      })\r\n      .then(function () {\r\n        return createEmptyImage(gameID); \r\n      })\r\n      .then(function () {\r\n        return createFolder(\"images\", gameID);\r\n      })\r\n      .then(function () {\r\n        return createFolder(\"sounds\", gameID);\r\n      })\r\n      .then(function () {\r\n        resolve(gameID);\r\n      })\r\n      .catch(function (error) {\r\n        console.error(\"Failed to create game:\", error);\r\n        reject(error);\r\n      });\r\n  });\r\n}\r\n\r\nfunction editGame(menuItemHTML) {\r\n  var gameID = menuItemHTML.parentNode.getAttribute(\"gameid\");\r\n  var url = \"editor/?id=\" + gameID;\r\n  if (openWindows[url] && !openWindows[url].closed) openWindows[url].focus();\r\n  else openWindows[url] = window.open(url, \"_blank\");\r\n  expandContainer.style.display = 'none';\r\n  expandContainerUl.setAttribute('gameid', '');\r\n}\r\n\r\nfunction playGame(menuItemHTML) {\r\n  var gameID = menuItemHTML.parentNode.getAttribute(\"gameid\");\r\n  var url = \"engine/?id=\" + gameID;\r\n  if (openWindows[url] && !openWindows[url].closed) openWindows[url].focus();\r\n  else openWindows[url] = window.open(url, \"_blank\");\r\n  expandContainer.style.display = 'none';\r\n  expandContainerUl.setAttribute('gameid', '');\r\n}\r\n\r\nasync function duplicateGame(gameID) {\r\n\r\n  return new Promise((resolve, reject) => {\r\n    gapi.client.drive.files.get({\r\n      'fileId': gameID,\r\n      'fields': 'name, parents'\r\n    }).then(response => {\r\n      console.log('Game Folder Retrieved');\r\n      const duplicateFolderName = response.result.name + ' - Copy';\r\n      gapi.client.drive.files.create({\r\n        'resource': {\r\n          'name': duplicateFolderName,\r\n          'mimeType': 'application/vnd.google-apps.folder',\r\n          'parents': response.result.parents\r\n        }\r\n      }).then(res => {\r\n\r\n        const newDirectoryId = res.result.id;\r\n\r\n        copyDirectoryContents(gameID, newDirectoryId, duplicateFolderName).then(() => {\r\n          resolve();\r\n        }).catch(error => {\r\n          reject(new Error('Error copying directory contents: ' + error.message));\r\n        });\r\n      }).catch(error => {\r\n        reject(new Error('Error creating duplicated game folder: ' + error.message));\r\n      });\r\n    }).catch(error => {\r\n      reject(new Error('Error retrieving game folder: ' + error.message));\r\n    });\r\n  });\r\n}\r\n\r\nasync function deleteGame(gameID, gameName) {\r\n  var result = window.confirm(`Do you want to delete the \"${gameName}\" game?`);\r\n  if (result) {\r\n    try {\r\n      await gapi.client.drive.files.delete({\r\n        'fileId': gameID\r\n      });\r\n      console.log('File Deleted');\r\n    } catch (error) {\r\n      console.error('Error deleting game:', error.message);\r\n    }\r\n  } else {\r\n    console.log('Option selected: false');\r\n  }\r\n}\r\n\r\nasync function copyDirectoryContents(sourceDirectoryId, destinationDirectoryId, duplicateFolderName) {\r\n  return new Promise(async (resolve, reject) => {\r\n    try {\r\n      const response = await gapi.client.drive.files.list({\r\n        'q': \"'\" + sourceDirectoryId + \"' in parents\",\r\n        'fields': 'files(id, name, mimeType)'\r\n      });\r\n      const files = response.result.files;\r\n      const copyFilePromises = files.map(async (file) => {\r\n        if (file.mimeType === 'application/vnd.google-apps.folder') {\r\n          await duplicateSubdirectory(file.id, destinationDirectoryId);\r\n        } else {\r\n          const copyRes = await gapi.client.drive.files.copy({\r\n            'fileId': file.id,\r\n            'parents': [destinationDirectoryId]\r\n          });\r\n          console.log('File Copied: ' + copyRes.result.name);\r\n          if (copyRes.result.name === \"game.json\") {\r\n            const originalGameJsonId = await getJson(sourceDirectoryId);\r\n            console.log('ID del archivo game.json:', originalGameJsonId);\r\n            await changeNameInJson(copyRes.result.id, originalGameJsonId, duplicateFolderName);\r\n          }\r\n        }\r\n      });\r\n      await Promise.all(copyFilePromises);\r\n      resolve();\r\n    } catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n}\r\n\r\nfunction getJson(directoryId) {\r\n  var request = gapi.client.drive.files.list({\r\n    'q': \"name='game.json' and '\" + directoryId + \"' in parents\",\r\n    'fields': 'files(id)'\r\n  });\r\n\r\n  return new Promise(function (resolve, reject) {\r\n    request.execute(function (res) {\r\n      if (res.files.length > 0) {\r\n        var gameJsonId = res.files[0].id;\r\n        resolve(gameJsonId);\r\n      } else {\r\n        reject(new Error('No se encontró el archivo game.json en la carpeta original.'));\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction changeNameInJson(duplicatedDirectoryId, originalGameJsonId, newName) {\r\n  var request = gapi.client.drive.files.get({\r\n    'fileId': originalGameJsonId,\r\n    'alt': 'media'\r\n  });\r\n\r\n  request.execute(function (res) {\r\n    var gameJsonContent = res;\r\n    gameJsonContent.name = newName;\r\n\r\n    var updatedJsonString = JSON.stringify(gameJsonContent);\r\n\r\n    var updateRequest = gapi.client.request({\r\n      'path': '/upload/drive/v3/files/' + duplicatedDirectoryId,\r\n      'method': 'PATCH',\r\n      'params': {\r\n        'uploadType': 'media'\r\n      },\r\n      'headers': {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      'body': updatedJsonString\r\n    });\r\n\r\n    updateRequest.execute(function (updateRes) {\r\n      console.log('Nombre del juego duplicado actualizado: ' + newName);\r\n    });\r\n  });\r\n}\r\n\r\nfunction duplicateSubdirectory(sourceSubdirectoryId, destinationParentId) {\r\n  var request = gapi.client.drive.files.get({\r\n    'fileId': sourceSubdirectoryId,\r\n    'fields': 'name, parents'\r\n  });\r\n  request.execute(function (res) {\r\n    console.log('Subdirectory Retrieved');\r\n    var subdirectoryData = res;\r\n    var copyRequest = gapi.client.drive.files.create({\r\n      'resource': {\r\n        'name': subdirectoryData.name,\r\n        'mimeType': 'application/vnd.google-apps.folder',\r\n        'parents': [destinationParentId]\r\n      }\r\n    });\r\n    copyRequest.execute(function (copyRes) {\r\n      console.log('Subdirectory Duplicated');\r\n      var duplicatedSubdirectoryId = copyRes.id;\r\n      copyDirectoryContents(sourceSubdirectoryId, duplicatedSubdirectoryId);\r\n    });\r\n  });\r\n}\r\n\r\n\r\nfunction createFolder(folderName, parent,accessToken) {\r\n  console.log(\"createFolder \", folderName, parent);\r\n  return new Promise(function (resolve, reject) {\r\n    var request = gapi.client.request({\r\n      path: '/drive/v3/files',\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': 'Bearer ' + accessToken,\r\n      },\r\n      body: {\r\n        'name': folderName,\r\n        'mimeType': 'application/vnd.google-apps.folder',\r\n        'parents': [parent]\r\n      }\r\n    });\r\n    request.execute(function (response) {\r\n      if (response.error) {\r\n        reject(new Error('Failed to create folder: ' + response.error.message));\r\n      } else if (response.id) {\r\n        resolve(response.id);\r\n      } else {\r\n        reject(new Error('Failed to create folder.'));\r\n      }\r\n    });\r\n  });\r\n}\r\n// Exporta las funciones necesarias si es necesario\r\nfunction createEmptyJson(gameID) {\r\n  return new Promise(function (resolve, reject) {\r\n    var request = gapi.client.request({\r\n      path: '/drive/v3/files',\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': 'Bearer ' + accessToken,\r\n      },\r\n      body: {\r\n        'name': 'game.json',\r\n        'mimeType': 'application/json',\r\n        'parents': [gameID]\r\n      }\r\n    });\r\n    request.execute(function (response) {\r\n      if (response.error) {\r\n        reject(new Error('Failed to create JSON file: ' + response.error.message));\r\n      } else if (response.id) {\r\n        resolve(response.id);\r\n      } else {\r\n        reject(new Error('Failed to create JSON file.'));\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction createEmptyImage(gameID) {\r\n  return new Promise(function (resolve, reject) {\r\n\r\n    var metadata = {\r\n      'name': 'image.jpg',\r\n      'parents': [gameID]\r\n    };\r\n    // Crear una imagen en blanco de 1x1 píxeles\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 1;\r\n    canvas.height = 1;\r\n    var context = canvas.getContext('2d');\r\n    context.fillStyle = '#ffffff'; // Color blanco\r\n    context.fillRect(0, 0, 1, 1);\r\n    canvas.toBlob(function (blob) {\r\n      var reader = new FileReader();\r\n      reader.onloadend = function () {\r\n        var base64Data = reader.result.split(',')[1];\r\n\r\n        var boundary = '-------314159265358979323846';\r\n        var delimiter = '\\r\\n--' + boundary + '\\r\\n';\r\n        var close_delim = '\\r\\n--' + boundary + '--';\r\n\r\n        var multipartRequestBody =\r\n          delimiter +\r\n          'Content-Type: application/json\\r\\n\\r\\n' +\r\n          JSON.stringify(metadata) +\r\n          delimiter +\r\n          'Content-Type: image/jpeg\\r\\n' +\r\n          'Content-Transfer-Encoding: base64\\r\\n' +\r\n          '\\r\\n' +\r\n          base64Data +\r\n          close_delim;\r\n\r\n        gapi.client.request({\r\n          path: '/upload/drive/v3/files',\r\n          method: 'POST',\r\n          params: {\r\n            'uploadType': 'multipart'\r\n          },\r\n          headers: {\r\n            'Content-Type': 'multipart/related; boundary=\"' + boundary + '\"',\r\n            'Authorization': 'Bearer ' + accessToken\r\n          },\r\n          body: multipartRequestBody\r\n        }).then(function (response) {\r\n          var fileId = response.result.id;\r\n          resolve(fileId);\r\n        }).catch(function (error) {\r\n          reject(new Error('Failed to create image file: ' + error.result.error.message));\r\n        });\r\n      };\r\n\r\n      reader.readAsDataURL(blob);\r\n    }, 'image/jpeg');\r\n  });\r\n}\r\n\r\nexport {\r\n  setDriveAccessToken,\r\n  folderExists,\r\n  createFolder,\r\n  checkDriveFolder,\r\n  listDriveGames,\r\n  newGame,\r\n  editGame,\r\n  playGame,\r\n  deleteGame,\r\n  duplicateGame\r\n};\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}