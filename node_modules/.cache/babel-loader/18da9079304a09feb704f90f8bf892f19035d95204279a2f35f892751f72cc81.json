{"ast":null,"code":"// /src/api/googleAPI.js\n/* global gapi, google  */\n\nconst userInfoEndpoint = 'https://www.googleapis.com/oauth2/v1/userinfo';\nlet tokenClient;\nexport async function initGoogleAPI(CLIENT_ID, API_KEY, DISCOVERY_DOCS, SCOPES) {\n  try {\n    await new Promise((resolve, reject) => {\n      gapi.load('client:auth2', () => {\n        gapi.client.init({\n          apiKey: API_KEY,\n          discoveryDocs: DISCOVERY_DOCS\n        }).then(resolve).catch(reject);\n      });\n    });\n    tokenClient = google.accounts.oauth2.initTokenClient({\n      client_id: CLIENT_ID,\n      scope: SCOPES,\n      prompt: ''\n    });\n  } catch (error) {\n    console.error(`Google API initialization failed: ${error.message}`);\n  }\n}\nexport async function login(firstTime) {\n  try {\n    const token = await new Promise((resolve, reject) => {\n      tokenClient.callback = response => {\n        if (response.error) {\n          reject(`Login failed: ${response.error}`);\n        } else {\n          resolve(response);\n        }\n      };\n      console.log(firstTime);\n      if (firstTime) {\n        tokenClient.requestAccessToken({\n          prompt: 'consent'\n        });\n      } else {\n        tokenClient.requestAccessToken({\n          prompt: 'none'\n        });\n      }\n    });\n    return token;\n  } catch (error) {\n    console.error(`Error during login or user info retrieval: ${error.message}`);\n  }\n}\nexport async function logout() {\n  try {\n    //google.accounts.id.disableAutoSelect();\n  } catch (error) {\n    console.error(`Error during logout: ${error.message}`);\n  }\n}\nexport async function getUserInfo(accessToken) {\n  try {\n    const response = await fetch(userInfoEndpoint, {\n      headers: {\n        Authorization: `Bearer ${accessToken}`\n      }\n    });\n    if (!response.ok) throw new Error('Failed to fetch user info');\n    return await response.json();\n  } catch (error) {\n    throw new Error(`Error during user info retrieval: ${error.message}`);\n  }\n}","map":{"version":3,"names":["userInfoEndpoint","tokenClient","initGoogleAPI","CLIENT_ID","API_KEY","DISCOVERY_DOCS","SCOPES","Promise","resolve","reject","gapi","load","client","init","apiKey","discoveryDocs","then","catch","google","accounts","oauth2","initTokenClient","client_id","scope","prompt","error","console","message","login","firstTime","token","callback","response","log","requestAccessToken","logout","getUserInfo","accessToken","fetch","headers","Authorization","ok","Error","json"],"sources":["D:/xampp/htdocs/src/apis/googleAPI.js"],"sourcesContent":["// /src/api/googleAPI.js\r\n/* global gapi, google  */\r\n\r\nconst userInfoEndpoint = 'https://www.googleapis.com/oauth2/v1/userinfo';\r\n\r\nlet tokenClient;\r\n\r\nexport async function initGoogleAPI(CLIENT_ID, API_KEY, DISCOVERY_DOCS, SCOPES) {\r\n  try {\r\n    await new Promise((resolve, reject) => {\r\n      gapi.load('client:auth2', () => {\r\n        gapi.client.init({\r\n          apiKey: API_KEY,\r\n          discoveryDocs: DISCOVERY_DOCS,\r\n        }).then(resolve).catch(reject);\r\n      });\r\n    });\r\n    tokenClient = google.accounts.oauth2.initTokenClient({\r\n      client_id: CLIENT_ID,\r\n      scope: SCOPES,\r\n      prompt: '',\r\n    });\r\n  } catch (error) {\r\n    console.error(`Google API initialization failed: ${error.message}`);\r\n  }\r\n}\r\n\r\nexport async function login(firstTime) {\r\n  try {\r\n    const token = await new Promise((resolve, reject) => {\r\n      tokenClient.callback = (response) => {\r\n        if (response.error) {\r\n          reject(`Login failed: ${response.error}`);\r\n        } else {\r\n          resolve(response);\r\n        }\r\n      };\r\n      console.log(firstTime);\r\n      if (firstTime) {\r\n        tokenClient.requestAccessToken({ prompt: 'consent' });\r\n      } else {\r\n        tokenClient.requestAccessToken({ prompt: 'none' });\r\n      }\r\n    });\r\n    return token;\r\n  } catch (error) {\r\n    console.error(`Error during login or user info retrieval: ${error.message}`);\r\n  }\r\n}\r\n\r\nexport async function logout() {\r\n  try {\r\n    //google.accounts.id.disableAutoSelect();\r\n  } catch (error) {\r\n    console.error(`Error during logout: ${error.message}`);\r\n  }\r\n}\r\n\r\nexport async function getUserInfo(accessToken) {\r\n  try {\r\n    const response = await fetch(userInfoEndpoint, {\r\n      headers: { Authorization: `Bearer ${accessToken}` }\r\n    });\r\n    if (!response.ok) throw new Error('Failed to fetch user info');\r\n    return await response.json();\r\n  } catch (error) {\r\n    throw new Error(`Error during user info retrieval: ${error.message}`);\r\n  }\r\n}\r\n\r\n\r\n"],"mappings":"AAAA;AACA;;AAEA,MAAMA,gBAAgB,GAAG,+CAA+C;AAExE,IAAIC,WAAW;AAEf,OAAO,eAAeC,aAAaA,CAACC,SAAS,EAAEC,OAAO,EAAEC,cAAc,EAAEC,MAAM,EAAE;EAC9E,IAAI;IACF,MAAM,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACrCC,IAAI,CAACC,IAAI,CAAC,cAAc,EAAE,MAAM;QAC9BD,IAAI,CAACE,MAAM,CAACC,IAAI,CAAC;UACfC,MAAM,EAAEV,OAAO;UACfW,aAAa,EAAEV;QACjB,CAAC,CAAC,CAACW,IAAI,CAACR,OAAO,CAAC,CAACS,KAAK,CAACR,MAAM,CAAC;MAChC,CAAC,CAAC;IACJ,CAAC,CAAC;IACFR,WAAW,GAAGiB,MAAM,CAACC,QAAQ,CAACC,MAAM,CAACC,eAAe,CAAC;MACnDC,SAAS,EAAEnB,SAAS;MACpBoB,KAAK,EAAEjB,MAAM;MACbkB,MAAM,EAAE;IACV,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAE,qCAAoCA,KAAK,CAACE,OAAQ,EAAC,CAAC;EACrE;AACF;AAEA,OAAO,eAAeC,KAAKA,CAACC,SAAS,EAAE;EACrC,IAAI;IACF,MAAMC,KAAK,GAAG,MAAM,IAAIvB,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACnDR,WAAW,CAAC8B,QAAQ,GAAIC,QAAQ,IAAK;QACnC,IAAIA,QAAQ,CAACP,KAAK,EAAE;UAClBhB,MAAM,CAAE,iBAAgBuB,QAAQ,CAACP,KAAM,EAAC,CAAC;QAC3C,CAAC,MAAM;UACLjB,OAAO,CAACwB,QAAQ,CAAC;QACnB;MACF,CAAC;MACDN,OAAO,CAACO,GAAG,CAACJ,SAAS,CAAC;MACtB,IAAIA,SAAS,EAAE;QACb5B,WAAW,CAACiC,kBAAkB,CAAC;UAAEV,MAAM,EAAE;QAAU,CAAC,CAAC;MACvD,CAAC,MAAM;QACLvB,WAAW,CAACiC,kBAAkB,CAAC;UAAEV,MAAM,EAAE;QAAO,CAAC,CAAC;MACpD;IACF,CAAC,CAAC;IACF,OAAOM,KAAK;EACd,CAAC,CAAC,OAAOL,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAE,8CAA6CA,KAAK,CAACE,OAAQ,EAAC,CAAC;EAC9E;AACF;AAEA,OAAO,eAAeQ,MAAMA,CAAA,EAAG;EAC7B,IAAI;IACF;EAAA,CACD,CAAC,OAAOV,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAE,wBAAuBA,KAAK,CAACE,OAAQ,EAAC,CAAC;EACxD;AACF;AAEA,OAAO,eAAeS,WAAWA,CAACC,WAAW,EAAE;EAC7C,IAAI;IACF,MAAML,QAAQ,GAAG,MAAMM,KAAK,CAACtC,gBAAgB,EAAE;MAC7CuC,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASH,WAAY;MAAE;IACpD,CAAC,CAAC;IACF,IAAI,CAACL,QAAQ,CAACS,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,2BAA2B,CAAC;IAC9D,OAAO,MAAMV,QAAQ,CAACW,IAAI,CAAC,CAAC;EAC9B,CAAC,CAAC,OAAOlB,KAAK,EAAE;IACd,MAAM,IAAIiB,KAAK,CAAE,qCAAoCjB,KAAK,CAACE,OAAQ,EAAC,CAAC;EACvE;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}