{"ast":null,"code":"// Edit.js\nimport React,{useEffect,useRef,useCallback}from'react';import{useNavigate}from'react-router-dom';import{useAppContext}from'../AppContext';import{useTheme}from'@mui/material/styles';import{jsx as _jsx}from\"react/jsx-runtime\";function Edit(){const{gameID,token,API_KEY,DISCOVERY_DOCS,gameList,setGameList}=useAppContext();const navigate=useNavigate();const iframeRef=useRef(null);const theme=useTheme();const handleCloseEditor=useCallback(event=>{if(event.origin===window.location.origin&&event.data&&event.data.type===\"closeEditor\"){const updatedList=gameList.map(game=>{if(game.id===event.data.data.id){return{...game,name:event.data.data.name};}return game;});setGameList(updatedList);navigate('/games');}},[navigate,gameList,setGameList]);useEffect(()=>{window.addEventListener('message',handleCloseEditor);return()=>window.removeEventListener('message',handleCloseEditor);},[handleCloseEditor]);const handleOpenEditor=useCallback(()=>{const messageData={type:'initEditor',data:{gameID,token,API_KEY,DISCOVERY_DOCS}};iframeRef.current.contentWindow.postMessage(messageData,window.location.origin);},[gameID,token,API_KEY,DISCOVERY_DOCS]);useEffect(()=>{if(iframeRef.current)iframeRef.current.onload=handleOpenEditor;},[handleOpenEditor]);return/*#__PURE__*/_jsx(\"div\",{style:{width:'100%',height:'100vh',overflow:'hidden',backgroundColor:theme.palette.primary.main},children:/*#__PURE__*/_jsx(\"iframe\",{title:\"Editor\",id:\"editorIframe\",ref:iframeRef,src:\"/LoopDrive/editor/index.html\",style:{width:'100%',height:'100%',border:'none'}})});}export default Edit;","map":{"version":3,"names":["React","useEffect","useRef","useCallback","useNavigate","useAppContext","useTheme","jsx","_jsx","Edit","gameID","token","API_KEY","DISCOVERY_DOCS","gameList","setGameList","navigate","iframeRef","theme","handleCloseEditor","event","origin","window","location","data","type","updatedList","map","game","id","name","addEventListener","removeEventListener","handleOpenEditor","messageData","current","contentWindow","postMessage","onload","style","width","height","overflow","backgroundColor","palette","primary","main","children","title","ref","src","border"],"sources":["D:/xampp/htdocs/src/pages/Edit.js"],"sourcesContent":["// Edit.js\r\nimport React, { useEffect, useRef, useCallback } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAppContext } from '../AppContext';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nfunction Edit() {\r\n  const { gameID, token, API_KEY, DISCOVERY_DOCS, gameList, setGameList } = useAppContext();\r\n  const navigate = useNavigate();\r\n  const iframeRef = useRef(null);\r\n  const theme = useTheme();\r\n\r\n  const handleCloseEditor = useCallback((event) => {\r\n    if (event.origin === window.location.origin && event.data && event.data.type === \"closeEditor\") {\r\n      const updatedList = gameList.map(game => {\r\n        if (game.id === event.data.data.id) {\r\n          return { ...game, name: event.data.data.name };\r\n        }\r\n        return game;\r\n      });\r\n      setGameList(updatedList);\r\n      navigate('/games');\r\n    }\r\n  }, [navigate, gameList, setGameList]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('message', handleCloseEditor);\r\n    return () => window.removeEventListener('message', handleCloseEditor);\r\n  }, [handleCloseEditor]);\r\n\r\n  const handleOpenEditor = useCallback(() => {\r\n    const messageData = {\r\n      type: 'initEditor',\r\n      data: { gameID, token, API_KEY, DISCOVERY_DOCS }\r\n    };\r\n    iframeRef.current.contentWindow.postMessage(messageData, window.location.origin);\r\n  }, [gameID, token, API_KEY, DISCOVERY_DOCS]);\r\n\r\n  useEffect(() => {\r\n    if (iframeRef.current) iframeRef.current.onload = handleOpenEditor;\r\n  }, [handleOpenEditor]);\r\n\r\n  return (\r\n    <div style={{ width: '100%', height: '100vh', overflow: 'hidden', backgroundColor: theme.palette.primary.main }}>\r\n      <iframe\r\n        title=\"Editor\"\r\n        id=\"editorIframe\"\r\n        ref={iframeRef}\r\n        src=\"/LoopDrive/editor/index.html\"\r\n        style={{ width: '100%', height: '100%', border: 'none' }}\r\n      ></iframe>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Edit;\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,WAAW,KAAQ,OAAO,CAC7D,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,aAAa,KAAQ,eAAe,CAC7C,OAASC,QAAQ,KAAQ,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEhD,QAAS,CAAAC,IAAIA,CAAA,CAAG,CACd,KAAM,CAAEC,MAAM,CAAEC,KAAK,CAAEC,OAAO,CAAEC,cAAc,CAAEC,QAAQ,CAAEC,WAAY,CAAC,CAAGV,aAAa,CAAC,CAAC,CACzF,KAAM,CAAAW,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAa,SAAS,CAAGf,MAAM,CAAC,IAAI,CAAC,CAC9B,KAAM,CAAAgB,KAAK,CAAGZ,QAAQ,CAAC,CAAC,CAExB,KAAM,CAAAa,iBAAiB,CAAGhB,WAAW,CAAEiB,KAAK,EAAK,CAC/C,GAAIA,KAAK,CAACC,MAAM,GAAKC,MAAM,CAACC,QAAQ,CAACF,MAAM,EAAID,KAAK,CAACI,IAAI,EAAIJ,KAAK,CAACI,IAAI,CAACC,IAAI,GAAK,aAAa,CAAE,CAC9F,KAAM,CAAAC,WAAW,CAAGZ,QAAQ,CAACa,GAAG,CAACC,IAAI,EAAI,CACvC,GAAIA,IAAI,CAACC,EAAE,GAAKT,KAAK,CAACI,IAAI,CAACA,IAAI,CAACK,EAAE,CAAE,CAClC,MAAO,CAAE,GAAGD,IAAI,CAAEE,IAAI,CAAEV,KAAK,CAACI,IAAI,CAACA,IAAI,CAACM,IAAK,CAAC,CAChD,CACA,MAAO,CAAAF,IAAI,CACb,CAAC,CAAC,CACFb,WAAW,CAACW,WAAW,CAAC,CACxBV,QAAQ,CAAC,QAAQ,CAAC,CACpB,CACF,CAAC,CAAE,CAACA,QAAQ,CAAEF,QAAQ,CAAEC,WAAW,CAAC,CAAC,CAErCd,SAAS,CAAC,IAAM,CACdqB,MAAM,CAACS,gBAAgB,CAAC,SAAS,CAAEZ,iBAAiB,CAAC,CACrD,MAAO,IAAMG,MAAM,CAACU,mBAAmB,CAAC,SAAS,CAAEb,iBAAiB,CAAC,CACvE,CAAC,CAAE,CAACA,iBAAiB,CAAC,CAAC,CAEvB,KAAM,CAAAc,gBAAgB,CAAG9B,WAAW,CAAC,IAAM,CACzC,KAAM,CAAA+B,WAAW,CAAG,CAClBT,IAAI,CAAE,YAAY,CAClBD,IAAI,CAAE,CAAEd,MAAM,CAAEC,KAAK,CAAEC,OAAO,CAAEC,cAAe,CACjD,CAAC,CACDI,SAAS,CAACkB,OAAO,CAACC,aAAa,CAACC,WAAW,CAACH,WAAW,CAAEZ,MAAM,CAACC,QAAQ,CAACF,MAAM,CAAC,CAClF,CAAC,CAAE,CAACX,MAAM,CAAEC,KAAK,CAAEC,OAAO,CAAEC,cAAc,CAAC,CAAC,CAE5CZ,SAAS,CAAC,IAAM,CACd,GAAIgB,SAAS,CAACkB,OAAO,CAAElB,SAAS,CAACkB,OAAO,CAACG,MAAM,CAAGL,gBAAgB,CACpE,CAAC,CAAE,CAACA,gBAAgB,CAAC,CAAC,CAEtB,mBACEzB,IAAA,QAAK+B,KAAK,CAAE,CAAEC,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,OAAO,CAAEC,QAAQ,CAAE,QAAQ,CAAEC,eAAe,CAAEzB,KAAK,CAAC0B,OAAO,CAACC,OAAO,CAACC,IAAK,CAAE,CAAAC,QAAA,cAC9GvC,IAAA,WACEwC,KAAK,CAAC,QAAQ,CACdnB,EAAE,CAAC,cAAc,CACjBoB,GAAG,CAAEhC,SAAU,CACfiC,GAAG,CAAC,8BAA8B,CAClCX,KAAK,CAAE,CAAEC,KAAK,CAAE,MAAM,CAAEC,MAAM,CAAE,MAAM,CAAEU,MAAM,CAAE,MAAO,CAAE,CAClD,CAAC,CACP,CAAC,CAEV,CAEA,cAAe,CAAA1C,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}